---
import Editor from '@components/Editor.astro'
import Layout from '../layouts/Layout.astro'
import Header from '@components/Header.astro'
import Shortcuts from '@components/Shortcuts.astro'
import Instructions from '@components/Instructions.astro'
---

<Layout>
	<script>
		if (localStorage.getItem('saw-home') !== 'true') {
			location.href = '/hello'
		}
	</script>
	<Header />
	<Editor />
	<Instructions />
	<Shortcuts />
</Layout>
<script>
	const registerServiceWorker = async (name) => {
		if ('serviceWorker' in navigator) {
			try {
				const registration = await navigator.serviceWorker.register(
					name,
					{
						scope: '/',
					},
				)
				if (registration.installing) {
					console.debug('Service worker installing')
				} else if (registration.waiting) {
					console.debug('Service worker installed')
				} else if (registration.active) {
					console.debug('Service worker active')
				}
			} catch (error) {
				console.error(`Registration failed with ${error}`)
			}
		}
	}
	console.debug('Page called')
	registerServiceWorker('/sw.js')

	import MicroModal from 'micromodal'
	MicroModal.init({ disableFocus: true, debug: false })
</script>
