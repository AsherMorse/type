---
import '@styles/header.sass'
import '@styles/editor.sass'
import '@styles/notes.sass'
---

<main></main>
<script>
	import { createEditor } from '@scripts/editor/create'
	import { initDragAndDrop } from '@scripts/editor/initDragAndDrop'
	import { reopenLastNote } from '@scripts/editor/reopenLastNote'
	import { initShortcuts } from '@scripts/editor/shortcuts'
	import { header } from '@scripts/header/elements'
	import { initMenuElements } from '@scripts/menu/elements'
	import { initMenuListeners } from '@scripts/menu/listeners'
	import { loadByURL } from '@scripts/note/loadByURL'
	import { toggleAutosave } from '@scripts/note/save'
	import { updateNotesList } from '@scripts/render/notes'
	import { initStatus } from '@scripts/render/showStatus'
	import { initState, state } from '@scripts/state'
	import { setFocus } from '@scripts/utils/setFocus'
	import {
		initFocusListener,
		initNavigationListener,
		initUnloadListener,
	} from '@scripts/utils/systemListenters'

	await initState()
	initMenuElements(header.headerEl)
	initStatus(header.headerEl)

	state.editor = await createEditor()

	await loadByURL()
	reopenLastNote()
	updateNotesList()
	setFocus(state.editorEl)
	toggleAutosave(true)

	initShortcuts(header.uploadInputEl)
	initNavigationListener()
	initFocusListener()
	initUnloadListener()
	initMenuListeners()
	initDragAndDrop()
</script>
